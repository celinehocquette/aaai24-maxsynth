great_ne(A,B):-ring_subst_2(B,C),h_acceptor(C,D),ring_subst_2(A,E),h_acceptor(E,D),x_subst(B,F,G).
great_ne(jj1,x1).
great_ne(jj1,h1).
great_ne(u1,aa1).
great_ne(u1,y1).
great_ne(cc1,u1).
great_ne(ii1,i1).
great_ne(z1,p1).
great_ne(kk1,dd1).
great_ne(u1,k1).
great_ne(H,I):-ring_subst_4(I,J),h_acceptor(J,K),great_h_acc(K,L),r_subst_3(H,M).
great_ne(aa1,k1).
great_ne(bb1,k1).
great_ne(q1,bb1).
great_ne(p1,u1).
great_ne(t1,u1).
great_ne(t1,h1).
great_ne(p1,x1).
great_ne(t1,hh1).
great_ne(ee1,x1).
great_ne(cc1,dd1).
great_ne(b1,h1).
great_ne(kk1,hh1).
great_ne(aa1,x1).
great_ne(q1,k1).
great_ne(dd1,bb1).
great_ne(z1,cc1).
great_ne(b1,ff1).
great_ne(N,O):-ring_subst_4(O,P),alk_groups(N,Q),gt(Q,R),ring_substitutions(N,R),x_subst(O,S,T).
great_ne(q1,aa1).
great_ne(f1,c1).
great_ne(bb1,x1).
great_ne(u1,v1).
great_ne(k1,w1).
great_ne(m1,w1).
great_ne(k1,y1).
great_ne(U,V):-ring_subst_3(U,W),alk_groups(U,X),ring_substitutions(U,X),x_subst(V,Y,W).
great_ne(t1,ee1).
great_ne(v1,i1).
great_ne(jj1,w1).
great_ne(x1,y1).
great_ne(z1,ee1).
great_ne(ii1,h1).
great_ne(bb1,h1).
great_ne(hh1,x1).
great_ne(cc1,i1).
great_ne(ee1,k1).
great_ne(t1,i1).
great_ne(p1,dd1).
great_ne(t1,x1).
great_ne(v1,h1).
great_ne(b1,i1).
great_ne(ee1,h1).
great_ne(q1,i1).
great_ne(kk1,x1).
great_ne(z1,hh1).
great_ne(u1,ii1).
great_ne(p1,aa1).
great_ne(bb1,i1).
great_ne(u1,h1).
great_ne(p1,w1).
great_ne(t1,dd1).
great_ne(Z,A1):-ring_subst_2(Z,B1),alk_groups(Z,C1),ring_substitutions(Z,C1),x_subst(A1,D1,B1).
great_ne(E1,F1):-ring_subst_2(E1,G1),alk_groups(F1,H1),gt(H1,I1),ring_substitutions(E1,I1),x_subst(E1,J1,K1).
great_ne(f1,a1).
great_ne(q1,p1).
great_ne(ee1,i1).
great_ne(cc1,hh1).
great_ne(kk1,bb1).
great_ne(p1,cc1).
great_ne(u1,dd1).
great_ne(p1,jj1).
great_ne(z1,h1).
great_ne(k1,h1).
great_ne(hh1,dd1).
great_ne(L1,M1):-ring_subst_2(L1,N1),sigma(N1,O1),great_sigma(O1,P1),great_sigma(P1,Q1),r_subst_3(M1,R1).
great_ne(ee1,hh1).
great_ne(cc1,x1).
great_ne(ii1,y1).
great_ne(q1,jj1).
great_ne(w1,h1).
great_ne(u1,ee1).
great_ne(S1,T1):-ring_subst_3(S1,U1),polarisable(U1,V1),x_subst(T1,W1,X1),polarisable(X1,V1),great_polari(V1,Y1).
great_ne(v1,y1).
great_ne(p1,t1).
great_ne(Z1,A2):-ring_subst_4(A2,B2),h_acceptor(B2,C2),great_h_acc(C2,D2),ring_subst_3(Z1,E2),h_acceptor(E2,D2).
great_ne(cc1,h1).
great_ne(F2,G2):-ring_subst_4(G2,H2),h_acceptor(H2,I2),great_h_acc(I2,J2),ring_subst_4(F2,K2),h_acceptor(K2,J2).
great_ne(z1,u1).
great_ne(jj1,kk1).
great_ne(L2,M2):-alk_groups(M2,N2),alk_groups(L2,O2),gt(O2,N2),ring_substitutions(L2,N2).
great_ne(cc1,ee1).
great_ne(cc1,aa1).
great_ne(P2,Q2):-ring_subst_3(P2,R2),alk_groups(Q2,S2),gt(S2,T2),gt(T2,U2),gt(U2,V2).
great_ne(cc1,t1).
great_ne(W2,X2):-alk_groups(X2,Y2),gt(Y2,Z2),gt(Z2,A3),alk_groups(W2,Z2),ring_substitutions(W2,A3).
great_ne(B3,C3):-ring_subst_4(C3,D3),h_acceptor(D3,E3),great_h_acc(E3,F3),ring_subst_2(B3,G3),h_acceptor(G3,F3).
great_ne(z1,aa1).
great_ne(z1,jj1).
great_ne(q1,x1).
great_ne(v1,ii1).
great_ne(b1,c1).
great_ne(y1,h1).
great_ne(H3,I3):-ring_subst_2(I3,J3),flex(J3,K3),great_flex(K3,L3),ring_substitutions(H3,M3),gt(M3,N3).
great_ne(O3,P3):-ring_subst_6(P3,Q3),ring_substitutions(O3,R3).
great_ne(S3,T3):-alk_groups(T3,U3),ring_substitutions(S3,V3),gt(V3,U3).
great_ne(W3,X3):-ring_subst_4(X3,Y3),alk_groups(X3,Z3),alk_groups(W3,Z3),gt(Z3,A4),ring_substitutions(W3,A4).

% accuracy: 73.18840579710145
% learning time: 609.470802709
% combine time: None
